# 开发规范

## 数据库表与模型的定义

数据库表的定义:
    - 结构体名称, `表名+Stu`, 例如, Account 表的结构体名称为 AccountStu
    - 结构体内的属性都是可导出的
    - 数据表名称要写全, 尽量不要使用缩写, 除非是特别通用的缩写, 数据库表字段也是如此

模型的定义:
    - 结构体名称直接使用表名, 例如, Account 表的模型就为 Account
    - 结构体内的属性尽量是不可导出的, 保证模型变量的私有性

```
type AccountStu struct {
    ID   unit
    Name string
    ...
}

type Account struct {
   *gorm.DB
   wg sync.WaitGroup
   ...
}
```

## 变量及其命名

- 变量名称尽可能的符合上下文, 容易理解
- 常量变量名称尽可能全部大写, 例如, ONE, TWO 等
- 常量使用 `_` 进行分割, 这样可以保证可读性, 例如, STATUS_AUDIT
- 数字常量从 `1` 开始
- 尽量避免使用全局作用域的变量. 可以使用注册函数的方式让变量跨作用域.


## 函数及其命名

- 函数名称使用驼峰结构
- 函数名称要尽可能的描述函数的动作, 让人能够一看到函数名称就明白函数的功能. 
- 一个函数尽量不要超过 `150` 行, 如果超过, 需要考虑函数的拆分
- 函数内的变量命名要尽可能的符合函数语境, 而且要写全[除开特别通用的缩写 和 特殊的语句,如for循环], 这样方便阅读
- 必要的函数注释, 以及参数说明
- 使用换行形式的分块, 代码更加整洁, 同时方便阅读

## error 定义

- code, message, 制定错误码和错误消息
- 常用的 error, 只创建一次,全局使用

## package 引用问题

- 引用包的顺序, golang库包, 第三方库包, 当前项目包.
- 当引用的包的长度不一致时, 最好按照长度顺序进行依次引用.
- 关于点引用, 点引用的包, 一般是最顶层的包, 即不依赖或者很少依赖当前项目其他包的包. 一般点引用放在包引用的最后.

## 测试

- 功能函数测试, 目前主要是针对建立在数据库层面之上的 Model Service 的函数测试. 一般情况下, 主要针对复杂的函数测试, 简单常见的函数可以忽略之.
- API 测试, 一个API的测试用例至少有一个. 需要完整走一套 API 调用过程.
- 数据, json 数据或者手动构建测试数据函数.