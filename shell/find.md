# shell 三剑客 - find

find usage:
```
find [-H] [-L] [-P] [-D debugopts] [-Olevel] [starting-point...] [expression]
```

## OPTIONS

`-H`, `-L` 和 `-P` 选项控制符号链接的处理. 后面的命令行参数被认为是要检查的文件或目录的名称, 直到第一个以 `-` 开头的
参数, 或参数 `(`, 或 `!`

该参数和任何后续参数都被视为描述要搜索的内容的表达式.

- `-P`, 从不解析符号连接. 这时默认行为. 当 find 检查或打印文件信息时, 并且该文件是符号连接, 所使用的信息取自符号连接本
身的属性.

- `-L`, 解析符号连接. 当 find 检查或打印文件信息时, 并且该文件是符号连接, 所使用的信息来自符号连接指向的文件的属性(除
非它是断开的符号连接或find无法检查指向的文件). 如果 `-L` 有效并且 find 在其搜索过程中发行了指向子目录的符号连接, 则将
搜索符号链接指向的子目录.

当 `-L` 生效时, `-type` 参数将始终与符号链接指向的文件类型匹配(除非符号连接被破话).  使用 `-L` 会导致 `-lname` 和
`-ilname` 始终返回 false.

- `-H`, 不解析符号连接, 除非在处理命令行参数. 当 find 检查或打印文件信息时, 并且该文件是符号连接, 所使用的信息来自符号
连接本身的属性. 此行为的唯一例外是命令行上指向的文件是符号链接, 并且可以解析链接. 对于这种情况, 使用的信息取自连接指向的
任何内容. 


## EXPRESSION

expression 由一系列序列组成:

Test, 测试返回 true 或 false, 通常基于正在查找文件的某些属性. 例如, `-empty` 测试仅在当前文件为空是为true.

Action, 操作的结果, 并返回 true 或 false(通常取决于操作是否成功). 例如, `-print` 操作在标准输出上打印当前文件的名称.

Global Option, 全局选项会影响在命令行的任何部分指定的测试和操作. 全局选项总是返回 true. 例如, `-depth` 选项使 find 
以深度优先的顺序遍历文件系统.

Position Option, 位置选项仅影响跟随它们的测试或操作. 位置选项总是返回 true. 例如, `-regextype` 为稍后在命令行上出
现的正则表达式指定方言.

Operation, 逻辑运算符将表达式中的其他选项连接在一起. 它们 `-o` (逻辑或), `-a` (逻辑与). 如果缺少运算符, 默认值为`-a`.

### GLOBAL OPTIONS

- `-depth` 采用深度优先遍历. 先处理目录当中的文件, 然后处理目录.

- `-maxdepth n`, 在起点以下的目录的最大深度向下遍历. `-maxdepth 0` 表示仅测试和操作起点本身.

- `-mindepth n`, 在不低于这个深度的文件和目录上进行测试和操作. `-mindepth 1` 表示处理除了起点之外的所有文件.

### TEST

- `-executable`, 文件对于当前用户可执行.

- `-readable`, 文件对于当前用户可读.

- `-writable`, 文件对于当前用户可写.

- `-type c`, 文件的类型:

```
b 块文件
c 字符文件
d 目录
f 普通文件
l 链接
p 命名管道
s socket
```

- `-size n[cwbkMG]`, 文件使用了 n 个单位大小的空间. 

```
b 对于 512 byte 块(缺省默认值单位)
c byte
w word(2 byte)
k KB(1024 byte)
M MB(1024*1024 byte)
G GB(1024*1024*1024 byte)
```

- `-name pattern`, 文件名(删除了前导目录路径)shell模式匹配. 因为前导目录被删除, 与 `-name` 匹配的文件名将永远不会
包含斜杠(`/`). 因此, `-name a/b` 永远不会匹配任何内容. 

- `-path pattern`, 文件名的shell模式匹配. 元字符不处理 `/` 或 `.`. 例如 `find . -path "./sr*sc"`, `./src/misc`(
如果存在的话), 将被输出. 想要忽略某个目录树, 请使用 `-purge`, 而不是检查树中的文件. 例如, 忽略目录 `src/emacs` 以及
其下的所有文件和目录: `find . -path ./src/emacs -purne -o -print`. 注意: 模式匹配测试适用于整个文件名. 如果起点
是绝对路径, 那么在这里使用绝对路径名才有意义. `find bar -path /foo/bar/myfile -print` 将永远不会匹配任何内容.

- `-regex pattern`, 文件名称匹配正则表达式. 这是整个路径上的匹配, 而不是搜索. 例如, 要匹配名为 `./fubar3` 的文件,
正则表达式可以为 `.*bar.` 或 `.*b.*3`, 但不是 `f.*r3`. find 的正则表达式默认是 Emacs 正则表达式, 这里可是使用选项
`-regextype` 进行更改.

### ACTION

- `-delete`, 删除文件, 如果删除成功, 则为 true. 如果删除失败, 则输出错误消息. 如果 `-delete` 失败, find 的退出状
态为非0. 使用 `-delete` 自动打开 `-depth` 选项.

- `-exec cmd ;`, 执行命令 cmd. 如果命令执行成功(退出状态为0), 则为 true. cmd 之后的所有参数都被视为命令的参数, 直
到由遇到 `;`. 字符串 `{}` 被当前文件名替换为正在处理的当前文件名, 它出现在 cmd 的参数中. 其中 `;` 是需要被转义的(使用
`\;`). 在某些版本当中, 字符串 `{}` 也是需要被转义的(使用 `\{\}`). 例如, 对每个子目录执行 ls 命令: `find . -type d -exec ls {} \;`

- `-exec cmd {} +`, 构建一个命令 cmd 来处理所有匹配的文件. 例如, 通过所有文件的总大小: `find . -type f -exec wc -c {} +` 

- `-prune`, 忽略某个目录, 返回 true. 如果给出 `-depth`, 则值为 false, 没有任何影响. 由于 `-delete` 意味着 `-depth`, 
所以 `-prune` 不能和 `-delete` 同时使用.

- `-print`, 打印每个匹配的文件的全路径名称.

