log_format main '$remote_addr - $remote_user [$time_local] "$request" '
                '$status $body_bytes_sent "$http_referer" '
                '"$http_user_agent" "$http_x_forwarded_for"';

server {
    listen 80;
    server_name test.backend.com;

    location / {
        if ($request_method = OPTIONS) {
            add_header 'Access-Control-Allow-Origin' "$http_origin";
            add_header 'Access-Control-Allow-Methods' "POST, GET, PUT, OPTIONS, DELETE";
            add_header 'Access-Control-Allow-Headers' "Origin, X-Requested-With, Content-Type, Accept, Authorization";
            add_header 'Access-Control-Allow-Credentials' "true";
            add_header 'Content-Type' "application/json; charset=UTF-8";
            return 200;
        }

        add_header 'Access-Control-Allow-Origin' "$http_origin";
        add_header 'Access-Control-Allow-Methods' "POST, GET, PUT, OPTIONS, DELETE";
        add_header 'Access-Control-Allow-Headers' "Origin, X-Requested-With, Content-Type, Accept, Authorization";
        add_header 'Access-Control-Allow-Credentials' "true";

        # 转发
        proxy_pass http://127.0.0.1:8080;
        access_log  /etc/sfbackend/access.log  main;
        error_log  /etc/sfbackend/error.log;
    }
}

